meta_data:
  script_path: run_scripts/adv_irl_exp_visual_script.py
  exp_name: gail_dmc_finger_spin
  description: Train an adversarial IRL model
  num_workers: 2 # 64
  using_gpus: true
# -----------------------------------------------------------------------------
variables:
  adv_irl_params:
    grad_pen_weight: [4.0] # [0.5, 1.0, 2.0, 4.0, 8.0, 16.0, 32.0, 64.0]
  # seed: [723894, 23789]
  seed: [723894]

# -----------------------------------------------------------------------------
constants:
  expert_name: 'finger_spin_sac_ae'
  expert_idx: 0
  traj_num: 4
  scale_env_with_demo_stats: false
  minmax_env_with_demo_stats: false

  disc_num_blocks: 2
  disc_hid_dim: 128
  disc_hid_act: tanh
  disc_use_bn: false
  disc_clamp_magnitude: 10.0

  policy_net_size: 256
  policy_num_hidden_layers: 2

  adv_irl_params:
    mode: 'gail'
    state_only: false

    num_epochs: 162
    num_steps_per_epoch: 10000
    num_steps_between_train_calls: 1000
    max_path_length: 1000
    min_steps_before_training: 5000

    eval_deterministic: true
    num_steps_per_eval: 10000
    
    replay_buffer_size: 20000
    no_terminal: true
    eval_no_terminal: false
    wrap_absorbing: false

    num_update_loops_per_train_call: 1000
    num_disc_updates_per_loop_iter: 1
    num_policy_updates_per_loop_iter: 1

    disc_lr: 0.0003
    disc_momentum: 0.9
    use_grad_pen: true
    # grad_pen_weight: 10.0
    disc_optim_batch_size: 256
    policy_optim_batch_size: 256
    policy_optim_batch_size_from_expert: 0

    save_best: true
    save_epoch: false
    freq_saving: 20
    save_replay_buffer: false
    # save_environment: false
    # save_environment: false

  encoder_params:
    encoder_feature_dim: 50
    encoder_type: 'pixel'
    decoder_type: 'pixel'
    num_layers: 4
    num_filters: 32

  sac_params:
    alpha: 0.1
    reward_scale: 1.0
    discount: 0.99
    soft_target_tau: 0.01
    enc_soft_target_tau: 0.05
    beta_1: 0.25
    policy_lr: 0.0003
    qf_lr: 0.0003
    vf_lr: 0.0003
    policy_mean_reg_weight: 0.001
    policy_std_reg_weight: 0.001

  env_specs:
    env_name: 'dmc'
    frame_stack: 3
    env_kwargs:
      domain_name: "finger"
      task_name: "spin"
      visualize_reward: false
      from_pixels: true
      height: 84
      width: 84
      frame_skip: 1

    env_num: 1 # This parameter define how many vec envs are created
    # eval_env_seed: 78236 # These two seeds are no longer needed since in our implementation we makes all seeds the same, see the script file, however you can change the script to make it valid
    training_env_seed: 24495
